<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Home</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="index.css" />        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body>
        <div id="topScheduleBar"></div>
        <div id="topNavBar">
            <div class="m_navButton">
                <div id="korean"class="navButton">국어</div>
                <div id="math"class="navButton">수학</div>
                <div id="science"class="navButton">과학</div>
            </div>
            <div class="m_navButton">
                <div id="english_R"class="navButton">영어-Red</div>
                <div id="english_B"class="navButton">영어-Blue</div>
                <div id="moral"class="navButton">도덕</div>
            </div>
            <div class="m_navButton">
                <div id="tech_and_house"class="navButton">기가</div>
                <div id="chinese"class="navButton">한문</div>
                <div id="dev_log"class="navButton">개발 일지</div>
            </div>
        </div>
        <div id="mainContents"></div>
        <script>
            $(".m_navButton div").click(function(e) {
                    $(".m_navButton div").removeClass("selected").addClass("navButton");
                    $(this).addClass("selected").removeClass("navButton");
                    let menu = $(this).attr('id');
                    if(menu==="korean") {
                        getContents(menu);
                    }else if(menu==="math"){
                        getContents(menu);
                    }else if(menu==="science"){
                        getContents(menu);
                    }else if(menu==="english_R"){
                        getContents(menu);
                    }else if(menu==="english_B"){
                        getContents(menu);
                    }else if(menu==="moral"){
                        getContents(menu);
                    }else if(menu==="tech_and_house"){
                        getContents(menu);
                    }else if(menu==="chinese"){
                        getContents(menu);
                    }else{
                        getContents(menu);
                    }
                    e.preventDefault();     
                }            
            );
                
            function getContents(menu){
                $.getJSON(`./${menu}.json`, function(data){
                    $("#mainContents").html("");
                    for(i in data){
                        const div = document.createElement("div");
                        div.setAttribute("id", i);
                        const img = document.createElement("img");
                        img.src = i;
                        img.classList.add("contImg")
                        const text = document.createElement("div");
                        text.id=`${i}_text`;
                        text.classList.add("contText");
                        document.getElementById("mainContents").appendChild(div);
                        document.getElementById(i).appendChild(img);
                        document.getElementById(i).appendChild(text);
                        console.log("test");
                    }                    
                        })
            }
            $(document).ready(function(){
                getEvent()
                write()
            })
            function write(){
                $.getJSON("./event.json", function(data){
                    let i = 0;
                    for(key in data.comingEvent){
                        $("#mainContents").append(`${++i}. ${key} - ${data.comingEvent[key]}<br>`);
                    }
                })
            }

            // 일정 롤링
            function getEvent(){
                var i = 0;
                var result = [];
                $.getJSON("./event.json", function(data){
                    for(j in data.comingEvent){
                        result.push([`${j} - ${data.comingEvent[j]}`]);
                    }
                    $("#topScheduleBar").text("Loading");
                    setInterval(function() {
                        $("#topScheduleBar").text(result[i]);
                        if (i == result.length-1)
                            i=0;
                        else
                            i++;
                    }, 4 * 1000);
                }).fail(function(){
                    $("topScheduleBar").text("Error");
                })
            }
        </script>
    </body>
</html>